# Traffic-flow-prediction

## 注意事项

<font face="微软雅黑" >需要注意的是，需要根据requirements.txt文件中指示的包进行安装，才能正常的运行程序！！！</font>
  
>* 首先，使用conda创建一个虚拟环境，如‘conda create traffic_flow’；  
> * 激活环境，conda activate traffic_flow；  
> * 安装环境，需要安装的环境已经添加在requirements.txt中，可以用conda安装，也可以使用pip安装，如：conda install tensorflow==1.12.0；  
> * 如果安装的是最新的tensorflow环境，也没问题，tensorflow的包按照以下方式进行导入即可：import tensorflow.compat.v1 as tf
tf.disable_v2_behavior()；  
> * 点击 run_train.py文件即可运行代码。
---

## 模型实验结果
### HA (Multi-steps)

### ARIMA (Multi-steps)

### LSTM (Multi-steps)

|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|embedding       |128      |128      |128      |128      |128      |128      |
|epoch           |100      |100      |100      |100      |100      |100      |
| MAE            |4.679756 |4.814935 |4.949264 |5.091296 |5.232986 |5.391583 |
| RMSE           |7.094228 |7.360590 |7.617431 |7.917681 |8.192226 |8.524423 |
| R              |0.973347 |0.971335 |0.969300 |0.966816 |0.964486 |0.961499 |
| R<sup>2</sup>  |0.947153 |0.943122 |0.939089 |0.934200 |0.929580 |0.923745 | 
 
### Bi-LSTM (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|embedding       |128      |128      |128      |128      |128      |128      |
|epoch           |100      |100      |100      |100      |100      |100      |
| MAE            |4.718628 |4.847933 |4.978020 |5.118784 |5.260451 |5.423886 |
| RMSE           |7.209488 |7.467735 |7.718245 |8.013406 |8.282809 |8.619274 |
| R              |0.972399 |0.970349 |0.968296 |0.965787 |0.963431 |0.960345 |
| R<sup>2</sup>  |0.945422 |0.941454 |0.937466 |0.932599 |0.928014 |0.922039 | 

### DELA (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|embedding       |128      |128      |128      |128      |128      |128      |
|epoch           |100      |100      |100      |100      |100      |100      |
| MAE            |4.813334 |4.788257 |4.868773 |5.070987 |5.150806 |5.276653 |
| RMSE           |6.846341 |7.023863 |7.100443 |7.459513 |7.620279 |7.792933 |
| MAPE           |0.407130 |0.403446 |0.411464 |0.428897 |0.436822 |0.445788 |
| R              |0.974227 |0.971634 |0.971496 |0.969438 |0.968001 |0.967635 |
| R<sup>2</sup>  |0.948067 |0.943325 |0.943608 |0.939415 |0.936777 |0.936271 | 

### STGNN (Multi-steps)
|  评价指标       |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |----     |----     |----     |----     |----     |
|embedding       |128      |128      |128      |128      |128      |128      |
|epoch           |100      |100      |100      |100      |100      |100      |
| mae            |4.512238 |4.579119 |4.656612 |4.738897 |4.808662 |4.879196 |
| rmse           |6.795296 |6.942279 |7.107975 |7.292534 |7.418278 |7.595171 |
| MAPE           |0.306675 |0.309785 |0.314120 |0.317842 |0.321344 |0.326065 |
| R              |0.975510 |0.974422 |0.973167 |0.971725 |0.970741 |0.969292 |
| R<sup>2</sup>  |0.951528 |0.949408 |0.946959 |0.944174 |0.942221 |0.939420 |

### GMAN (Multi-steps)  
> Embedding size is 256  


### ST-GAT (6-steps)  
#### 1-blocks and 1 heads for spatial, 4-blocks and 1 heads for temporal

|评价指标         |4-6 steps|5-6 steps|6-6 steps|7-6 steps|8-6 steps|9-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|epoch           |50       |50       |100      |100      |100      |100      |
|embedding       |64       |64       |64       | 64      |64       |64       |
| MAE            |14.322435|6.550879 |6.372804 |6.439330 |6.479654 |6.501210 |
| RMSE           |20.525616|10.132798|9.840441 |9.963966 |10.042691|10.095425|
| R              |0.927124 |0.968368 |0.970164 |0.969012 |0.968415 |0.968201 |
| R<sup>2</sup>  |0.739462 |0.936499 |0.940104 |0.938585 |0.937646 |0.936981 | 

#### 1-blocks and 4 heads for spatial, 1-blocks and 4 heads for temporal

|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|epoch           |100      |100      |100      |100      |100      |100      |
|embedding       |256      |256      |256      | 256     |256      |256      |
| MAE            |4.511082 |4.531373 |4.549260 |4.581149 |4.600930 |4.583859 |
| RMSE           |6.815795 |6.863963 |6.902728 |6.963062 |7.013478 |7.000430 |
| R              |0.975591 |0.975223 |0.974928 |0.974468 |0.974093 |0.974137 |
| R<sup>2</sup>  |0.951220 |0.950538 |0.949983 |0.949110 |0.948387 |0.948573 | 


step-step inference  
MAE is : 4.439943  
RMSE is : 6.775270  
R is: 0.975778  
R^$2$ is: 0.951828  

### MT-STNet (Multi-steps) without physical information

|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|epoch           |100      |100      |100      |100      |100      |100      |
|embedding       |256      |256      |256      | 256     |256      |256      |
| MAE            |4.357896 |4.277236 |4.308132 |4.378291 |4.453931 |4.457316 |
| RMSE           |6.500572 |6.545477 |6.534870 |6.706480 |6.816732 |6.807327 |
| MAPE           |0.287137 |0.293423 |0.290565 |0.291624 |0.290536 |0.291297 |
| R              |0.977097 |0.975799 |0.976535 |0.975769 |0.975872 |0.975913 |
| R<sup>2</sup>  |0.953181 |0.950782 |0.952234 |0.951030 |0.951244 |0.951371 | 