# Traffic-flow-prediction

## 注意事项

<font face="微软雅黑" >需要注意的是，需要根据requirements.txt文件中指示的包进行安装，才能正常的运行程序！！！</font>
  
>* 首先，使用conda创建一个虚拟环境，如‘conda create traffic_flow’；  
> * 激活环境，conda activate traffic_flow；  
> * 安装环境，需要安装的环境已经添加在requirements.txt中，可以用conda安装，也可以使用pip安装，如：conda install tensorflow==1.12.0；  
> * 如果安装的是最新的tensorflow环境，也没问题，tensorflow的包按照以下方式进行导入即可：import tensorflow.compat.v1 as tf
tf.disable_v2_behavior()；  
> * 点击 run_train.py文件即可运行代码。
---

## 模型实验结果
### LSTM (Multi-steps)

|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|embedding       |128      |128      |128      |128      |128      |128      |
|epoch           |100      |100      |100      |100      |100      |100      |
| MAE            |4.679756 |4.814935 |4.949264 |5.091296 |5.232986 |5.391583 |
| RMSE           |7.094228 |7.360590 |7.617431 |7.917681 |8.192226 |8.524423 |
| R              |0.973347 |0.971335 |0.969300 |0.966816 |0.964486 |0.961499 |
| R<sup>2</sup>  |0.947153 |0.943122 |0.939089 |0.934200 |0.929580 |0.923745 | 
 
### Bi-LSTM (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|embedding       |128      |128      |128      |128      |128      |128      |
|epoch           |100      |100      |100      |100      |100      |100      |
| MAE            |4.718628 |4.847933 |4.978020 |5.118784 |5.260451 |5.423886 |
| RMSE           |7.209488 |7.467735 |7.718245 |8.013406 |8.282809 |8.619274 |
| R              |0.972399 |0.970349 |0.968296 |0.965787 |0.963431 |0.960345 |
| R<sup>2</sup>  |0.945422 |0.941454 |0.937466 |0.932599 |0.928014 |0.922039 | 

### DELA (Multi-steps)
|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|embedding       |128      |128      |128      |128      |128      |128      |
|epoch           |100      |100      |100      |100      |100      |100      |
| MAE            |4.718628 |4.509632 |4.621311 |4.711585 |4.795986 |4.939281 |
| RMSE           |7.209488 |6.800318 |6.979517 |7.180182 |7.330795 |7.602418 |
| R              |0.972399 |0.975656 |0.974213 |0.972614 |0.971459 |0.969469 |
| R<sup>2</sup>  |0.945422 |0.951451 |0.948864 |0.945887 |0.943611 |0.939348 | 

### STGNN (Multi-steps)
|  评价指标       |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |----     |----     |----     |----     |----     |
|embedding       |128      |128      |128      |128      |128      |128      |
|epoch           |100      |100      |100      |100      |100      |100      |
| mae            |4.668860 |4.739987 |4.819024 |4.898437 |4.977795 |5.058583 |
| rmse           |6.976429 |7.128908 |7.294737 |7.464500 |7.631687 |7.800256 |
| R              |0.975510 |0.974397 |0.973167 |0.971883 |0.970586 |0.969247 |
| R<sup>2</sup>  |0.951528 |0.949362 |0.946967 |0.944466 |0.941945 |0.939347 |

### GMAN (Multi-steps)  

NEW DATA
MAE is : 4.706588
RMSE is : 7.173023
R is: 0.972917
R^$2$ is: 0.946006

> Embedding size is 256  

MAE is : 6.096133  
RMSE is : 9.411343  
R is: 0.972302  
R^$2$ is: 0.945214  

没加gcn
MAE is : 6.133067
RMSE is : 9.510901
R is: 0.971789
R^$2$ is: 0.944049

### ST-GAT (6-steps)  
#### 1-blocks and 1 heads for spatial, 4-blocks and 1 heads for temporal

|评价指标         |4-6 steps|5-6 steps|6-6 steps|7-6 steps|8-6 steps|9-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|epoch           |50       |50       |100      |100      |100      |100      |
|embedding       |64       |64       |64       | 64      |64       |64       |
| MAE            |14.322435|6.550879 |6.372804 |6.439330 |6.479654 |6.501210 |
| RMSE           |20.525616|10.132798|9.840441 |9.963966 |10.042691|10.095425|
| R              |0.927124 |0.968368 |0.970164 |0.969012 |0.968415 |0.968201 |
| R<sup>2</sup>  |0.739462 |0.936499 |0.940104 |0.938585 |0.937646 |0.936981 | 

#### 1-blocks and 4 heads for spatial, 1-blocks and 4 heads for temporal

|评价指标         |6-1 steps|6-2 steps|6-3 steps|6-4 steps|6-5 steps|6-6 steps|
|  ----          | ----    |  ----   |  ----   |----     |----     |----     |
|epoch           |100      |100      |100      |100      |100      |100      |
|embedding       |256      |256      |256      | 256     |256      |256      |
| MAE            |4.511082 |4.531373 |4.549260 |4.581149 |4.600930 |4.583859 |
| RMSE           |6.815795 |6.863963 |6.902728 |6.963062 |7.013478 |7.000430 |
| R              |0.975591 |0.975223 |0.974928 |0.974468 |0.974093 |0.974137 |
| R<sup>2</sup>  |0.951220 |0.950538 |0.949983 |0.949110 |0.948387 |0.948573 | 